%Script to test "BlockToeplitzInverse"
times = [1:17]'; %column

logtheta =input.logHypers;
K = squaredExp(logtheta, times);
K = K - se2*eye(17);
n = 1;
r = K(1,:);
[y logDet] =  BlockToeplitzInverse(r, se2,n)



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%CASE 1: %%  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
times = [1:17]'; %column

logtheta =[0.5194;-0.9429;0.1405];
K = squaredExp(logtheta, times);
blockSize = 1;
n = blockSize;
putIdentityOnDiag = false;

myMatrix = blockify(K, blockSize, putIdentityOnDiag);
myMatrix = myMatrix + 0.1*eye(size(myMatrix,1));

r = K(1,:);

invM = inv(myMatrix);
invM(2:n:end,1)
% ans =
% 
%    -3.2591
%    -0.0059
%    -0.0031
%    -0.0010
%    -0.0001
%     0.0001
%     0.0000
%     0.0000
%    -0.0000
%    -0.0000
%    -0.0000
%    -0.0000
%     0.0000
%     0.0000
%     0.0000
%    -0.0000
%    -0.0000
log(det(myMatrix))
% ans =
% 
%   -52.7550
[y logDet] =  BlockToeplitzInverse(r, 0.1,n)
% y =
% 
%   Columns 1 through 7
% 
%    -3.2591   -0.0059   -0.0031   -0.0010   -0.0001    0.0001    0.0000
%    -0.0059   -3.2586   -0.0057   -0.0030   -0.0010   -0.0001    0.0001
%    -0.0031   -0.0057   -3.2584   -0.0057   -0.0030   -0.0010   -0.0001
%    -0.0010   -0.0030   -0.0057   -3.2584   -0.0057   -0.0030   -0.0010
%    -0.0001   -0.0010   -0.0030   -0.0057   -3.2584   -0.0057   -0.0030
%     0.0001   -0.0001   -0.0010   -0.0030   -0.0057   -3.2584   -0.0057
%     0.0000    0.0001   -0.0001   -0.0010   -0.0030   -0.0057   -3.2584
%     0.0000    0.0000    0.0001   -0.0001   -0.0010   -0.0030   -0.0057
%    -0.0000    0.0000    0.0000    0.0001   -0.0001   -0.0010   -0.0030
%    -0.0000   -0.0000    0.0000    0.0000    0.0001   -0.0001   -0.0010
%    -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0001   -0.0001
%    -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0001
%     0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000
%     0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000
%     0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000
%    -0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000
%    -0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000
% 
%   Columns 8 through 14
% 
%     0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000
%     0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000
%     0.0001    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000
%    -0.0001    0.0001    0.0000    0.0000   -0.0000   -0.0000   -0.0000
%    -0.0010   -0.0001    0.0001    0.0000    0.0000   -0.0000   -0.0000
%    -0.0030   -0.0010   -0.0001    0.0001    0.0000    0.0000   -0.0000
%    -0.0057   -0.0030   -0.0010   -0.0001    0.0001    0.0000    0.0000
%    -3.2584   -0.0057   -0.0030   -0.0010   -0.0001    0.0001    0.0000
%    -0.0057   -3.2584   -0.0057   -0.0030   -0.0010   -0.0001    0.0001
%    -0.0030   -0.0057   -3.2584   -0.0057   -0.0030   -0.0010   -0.0001
%    -0.0010   -0.0030   -0.0057   -3.2584   -0.0057   -0.0030   -0.0010
%    -0.0001   -0.0010   -0.0030   -0.0057   -3.2584   -0.0057   -0.0030
%     0.0001   -0.0001   -0.0010   -0.0030   -0.0057   -3.2584   -0.0057
%     0.0000    0.0001   -0.0001   -0.0010   -0.0030   -0.0057   -3.2584
%     0.0000    0.0000    0.0001   -0.0001   -0.0010   -0.0030   -0.0057
%    -0.0000    0.0000    0.0000    0.0001   -0.0001   -0.0010   -0.0030
%    -0.0000   -0.0000    0.0000    0.0000    0.0001   -0.0001   -0.0010
% 
%   Columns 15 through 17
% 
%     0.0000   -0.0000   -0.0000
%     0.0000    0.0000   -0.0000
%     0.0000    0.0000    0.0000
%    -0.0000    0.0000    0.0000
%    -0.0000   -0.0000    0.0000
%    -0.0000   -0.0000   -0.0000
%    -0.0000   -0.0000   -0.0000
%     0.0000   -0.0000   -0.0000
%     0.0000    0.0000   -0.0000
%     0.0001    0.0000    0.0000
%    -0.0001    0.0001    0.0000
%    -0.0010   -0.0001    0.0001
%    -0.0030   -0.0010   -0.0001
%    -0.0057   -0.0030   -0.0010
%    -3.2584   -0.0057   -0.0031
%    -0.0057   -3.2586   -0.0059
%    -0.0031   -0.0059   -3.2591
% 
% 
% logDet =
% 
%   -52.7550
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%CASE 2: %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% randn('state', 1);
% rand('state', 1);

times = [1:10]'; %column

logtheta =[log(0.5);log(0.5);log(0.1)];
K = squaredExp(logtheta, times);
blockSize = 5;
n = blockSize;
putIdentityOnDiag = false;

myMatrix = blockify(K, blockSize, putIdentityOnDiag);
myMatrix = myMatrix + 0.1*eye(size(myMatrix,1));

r = K(1,:);

invM = inv(myMatrix);
invM(2:n:end,1)
% 
%    -1.8550
%    -0.0178
%     0.0021
%    -0.0003
%     0.0000
%    -0.0000
%     0.0000
%    -0.0000
%     0.0000
%    -0.0000

log(det(myMatrix))

% ans =
% 
%   -88.8728


[y logDet] =  BlockToeplitzInverse(r, 0.1,n)

% y =
% 
%   Columns 1 through 7
% 
%    -1.8550   -0.0178    0.0021   -0.0003    0.0000   -0.0000    0.0000
%    -0.0178   -1.8528   -0.0180    0.0022   -0.0003    0.0000   -0.0000
%     0.0021   -0.0180   -1.8528   -0.0180    0.0022   -0.0003    0.0000
%    -0.0003    0.0022   -0.0180   -1.8528   -0.0180    0.0022   -0.0003
%     0.0000   -0.0003    0.0022   -0.0180   -1.8528   -0.0180    0.0022
%    -0.0000    0.0000   -0.0003    0.0022   -0.0180   -1.8528   -0.0180
%     0.0000   -0.0000    0.0000   -0.0003    0.0022   -0.0180   -1.8528
%    -0.0000    0.0000   -0.0000    0.0000   -0.0003    0.0022   -0.0180
%     0.0000   -0.0000    0.0000   -0.0000    0.0000   -0.0003    0.0022
%    -0.0000    0.0000   -0.0000    0.0000   -0.0000    0.0000   -0.0003
% 
%   Columns 8 through 10
% 
%    -0.0000    0.0000   -0.0000
%     0.0000   -0.0000    0.0000
%    -0.0000    0.0000   -0.0000
%     0.0000   -0.0000    0.0000
%    -0.0003    0.0000   -0.0000
%     0.0022   -0.0003    0.0000
%    -0.0180    0.0022   -0.0003
%    -1.8528   -0.0180    0.0021
%    -0.0180   -1.8528   -0.0178
%     0.0021   -0.0178   -1.8550
% 
% 
% logDet =
% 
%   -88.8728

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%CASE 3: %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
times = [1:10]'; %column

logtheta =[log(.5);log(.8);log(0.1)];
K = squaredExp(logtheta, times);
blockSize = 5;
n = blockSize;
putIdentityOnDiag = false;

myMatrix = blockify(K, blockSize, putIdentityOnDiag);
myMatrix = myMatrix  + 0.5*eye(size(myMatrix,1));

r = K(1,:);

invM = inv(myMatrix);
invM(2:n:end,1)
% ans =
% 
%    -0.3459
%    -0.0063
%     0.0007
%    -0.0001
%     0.0000
%    -0.0000
%     0.0000
%    -0.0000
%     0.0000
%    -0.0000

log(det(myMatrix))

% ans =
% 
%    -14.6306

[y logDet] =  BlockToeplitzInverse(r, 0.5,n)
% y =
% 
%   Columns 1 through 7
% 
%    -0.3459   -0.0063    0.0007   -0.0001    0.0000   -0.0000    0.0000
%    -0.0063   -0.3452   -0.0064    0.0007   -0.0001    0.0000   -0.0000
%     0.0007   -0.0064   -0.3452   -0.0064    0.0007   -0.0001    0.0000
%    -0.0001    0.0007   -0.0064   -0.3452   -0.0064    0.0007   -0.0001
%     0.0000   -0.0001    0.0007   -0.0064   -0.3452   -0.0064    0.0007
%    -0.0000    0.0000   -0.0001    0.0007   -0.0064   -0.3452   -0.0064
%     0.0000   -0.0000    0.0000   -0.0001    0.0007   -0.0064   -0.3452
%    -0.0000    0.0000   -0.0000    0.0000   -0.0001    0.0007   -0.0064
%     0.0000   -0.0000    0.0000   -0.0000    0.0000   -0.0001    0.0007
%    -0.0000    0.0000   -0.0000    0.0000   -0.0000    0.0000   -0.0001
% 
%   Columns 8 through 10
% 
%    -0.0000    0.0000   -0.0000
%     0.0000   -0.0000    0.0000
%    -0.0000    0.0000   -0.0000
%     0.0000   -0.0000    0.0000
%    -0.0001    0.0000   -0.0000
%     0.0007   -0.0001    0.0000
%    -0.0064    0.0007   -0.0001
%    -0.3452   -0.0064    0.0007
%    -0.0064   -0.3452   -0.0063
%     0.0007   -0.0063   -0.3459
% 
% 
% logDet =
% 
%   -14.6306
